{"version":3,"sources":["../lib/index.js","../../node_modules/parcel-bundler/src/builtins/bundle-url.js","../../node_modules/parcel-bundler/src/builtins/bundle-loader.js","uiApp.js"],"names":["guessMapingRules","source","target","mappingRules","Object","entries","forEach","key","value","findPath","path","r","v","generateMappingCode","isGroovy","sourceCode","replace","RegExp","module","exports","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","require","loadBundlesLazy","bundles","Array","isArray","id","length","Promise","resolve","code","LazyPromise","reject","loadBundles","slice","then","all","map","loadBundle","bundleLoaders","registerBundleLoader","type","loader","load","register","bundle","substring","lastIndexOf","toLowerCase","bundleLoader","resolved","catch","e","executor","promise","prototype","onSuccess","onError","JSONEditor","Prism","loadVendors","sourceEditor","sourceContainer","document","querySelector","mode","p","firstname","lastname","others_data","birthdate","nationality","current_work","where","createSourceEditor","targetEditor","targetContainer","personne","firstName","lastName","current_work_type","current_work_place","createTargetEditor","getSourceCodeNode","addEventListener","generateSourceCode","get","formatedMappingRules","JSON","stringify","textContent","highlightElement"],"mappings":"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","file":"uiApp.14349678.map","sourceRoot":"../packages/ui","sourcesContent":["function guessMapingRules(source, target, mappingRules = {}) {\n  Object.entries(target).forEach(([key, value]) => {\n    if (typeof value === \"object\") {\n      mappingRules[key] = {}\n      guessMapingRules(source, value, mappingRules[key])\n    } else {\n      mappingRules[key] = findPath(value, source)\n    }\n  })\n  return mappingRules\n}\n\nfunction findPath(value, source, path = \"\") {\n  let r\n  Object.entries(source).forEach(([key, v]) => {\n    if (r) return\n    if (typeof v === \"object\") {\n      r = findPath(value, v, `${path}.${key}`)\n    } else {\n      if (value === v) {\n        r = `${path}.${key}`\n      }\n    }\n  })\n  return r\n}\n\nfunction generateMappingCode(mappingRules, isGroovy) {\n  let sourceCode = `\ntarget = ${mappingRules\n    .replace(new RegExp('\"\\\\.', \"g\"), \"source.\")\n    .replace(new RegExp('\",', \"g\"), \",\")\n    .replace(/\"\\n/g, \"\\n\")}\n    `\n  return isGroovy\n    ? sourceCode.replace(/\\{/g, \"[\").replace(/\\}/g, \"]\")\n    : sourceCode\n}\n\nif (typeof module !== \"undefined\") {\n  module.exports = {\n    guessMapingRules,\n    findPath,\n    generateMappingCode\n  }\n}\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var getBundleURL = require('./bundle-url').getBundleURL;\n\nfunction loadBundlesLazy(bundles) {\n  if (!Array.isArray(bundles)) {\n    bundles = [bundles]\n  }\n\n  var id = bundles[bundles.length - 1];\n\n  try {\n    return Promise.resolve(require(id));\n  } catch (err) {\n    if (err.code === 'MODULE_NOT_FOUND') {\n      return new LazyPromise(function (resolve, reject) {\n        loadBundles(bundles.slice(0, -1))\n          .then(function () {\n            return require(id);\n          })\n          .then(resolve, reject);\n      });\n    }\n\n    throw err;\n  }\n}\n\nfunction loadBundles(bundles) {\n  return Promise.all(bundles.map(loadBundle));\n}\n\nvar bundleLoaders = {};\nfunction registerBundleLoader(type, loader) {\n  bundleLoaders[type] = loader;\n}\n\nmodule.exports = exports = loadBundlesLazy;\nexports.load = loadBundles;\nexports.register = registerBundleLoader;\n\nvar bundles = {};\nfunction loadBundle(bundle) {\n  var id;\n  if (Array.isArray(bundle)) {\n    id = bundle[1];\n    bundle = bundle[0];\n  }\n\n  if (bundles[bundle]) {\n    return bundles[bundle];\n  }\n\n  var type = (bundle.substring(bundle.lastIndexOf('.') + 1, bundle.length) || bundle).toLowerCase();\n  var bundleLoader = bundleLoaders[type];\n  if (bundleLoader) {\n    return bundles[bundle] = bundleLoader(getBundleURL() + bundle)\n      .then(function (resolved) {\n        if (resolved) {\n          module.bundle.register(id, resolved);\n        }\n\n        return resolved;\n      }).catch(function(e) {\n        delete bundles[bundle];\n        \n        throw e;\n      });\n  }\n}\n\nfunction LazyPromise(executor) {\n  this.executor = executor;\n  this.promise = null;\n}\n\nLazyPromise.prototype.then = function (onSuccess, onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.then(onSuccess, onError)\n};\n\nLazyPromise.prototype.catch = function (onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.catch(onError)\n};\n","// If we \"sync\" import it put all the content in one big file\n// For demo purpose we load the vendors with import() to keep separated files\n/*\nimport JSONEditor from \"./vendors/jsoneditor\"\nimport Prism from \"./vendors/prism\" */\nimport { guessMapingRules, generateMappingCode } from \"../lib/index\"\n;(async function bootstrap() {\n  const [JSONEditor, Prism] = await loadVendors()\n\n  const sourceEditor = createSourceEditor()\n  const targetEditor = createTargetEditor()\n\n  getGenerateButton().addEventListener(\"click\", function clickOnGenerate() {\n    generateSourceCode(sourceEditor, targetEditor)\n  })\n\n  function generateSourceCode(sourceEditor, targetEditor) {\n    const mappingRules = guessMapingRules(\n      sourceEditor.get(),\n      targetEditor.get()\n    )\n\n    const formatedMappingRules = JSON.stringify(mappingRules, null, 4)\n    const sourceCode = generateMappingCode(formatedMappingRules)\n\n    getSourceCodeNode().textContent = sourceCode\n    Prism.highlightElement(getSourceCodeNode())\n  }\n\n  function createSourceEditor() {\n    var sourceContainer = document.querySelector(\"#source-jsoneditor\")\n    var options = { mode: \"code\" }\n    const source = {\n      p: {\n        firstname: \"Benoit\",\n        lastname: \"Vasseur\"\n      },\n      others_data: {\n        birthdate: \"14/10/1991\",\n        nationality: \"French\"\n      },\n      current_work: {\n        type: \"developer\",\n        where: \"Modulus Data; Levis, QC, Canada\"\n      }\n    }\n\n    return new JSONEditor(sourceContainer, options, source)\n  }\n\n  function createTargetEditor() {\n    var targetContainer = document.querySelector(\"#target-jsoneditor\")\n    var options = { mode: \"code\" }\n    const target = {\n      personne: {\n        firstName: \"Benoit\",\n        lastName: \"Vasseur\",\n        nationality: \"French\",\n        birthdate: \"14/10/1991\",\n        current_work_type: \"developer\",\n        current_work_place: \"Modulus Data; Levis, QC, Canada\"\n      }\n    }\n    return new JSONEditor(targetContainer, options, target)\n  }\n\n  function getGenerateButton() {\n    return document.querySelector(\"#generate-button\")\n  }\n\n  function getSourceCodeNode() {\n    return document.querySelector(\"#source-code\")\n  }\n\n  async function loadVendors() {\n    return Promise.all([\n      import(\"./vendors/jsoneditor\"),\n      import(\"./vendors/prism\")\n    ])\n  }\n})()\n"]}